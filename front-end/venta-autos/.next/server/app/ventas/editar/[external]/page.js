(()=>{var e={};e.id=251,e.ids=[251],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5209:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>o.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c});var n=a(482),r=a(9108),s=a(2563),o=a.n(s),i=a(8300),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);a.d(t,l);let c=["",{children:["ventas",{children:["editar",{children:["[external]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,5192)),"/home/ivan/WorkSpace/Practica3/front-end/venta-autos/app/ventas/editar/[external]/page.jsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,3384)),"/home/ivan/WorkSpace/Practica3/front-end/venta-autos/app/layout.js"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9361,23)),"next/dist/client/components/not-found-error"]}],d=["/home/ivan/WorkSpace/Practica3/front-end/venta-autos/app/ventas/editar/[external]/page.jsx"],u="/ventas/editar/[external]/page",h={require:a,loadChunk:()=>Promise.resolve()},m=new n.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/ventas/editar/[external]/page",pathname:"/ventas/editar/[external]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},7996:()=>{},2001:(e,t,a)=>{Promise.resolve().then(a.bind(a,8168))},2234:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,2583,23)),Promise.resolve().then(a.t.bind(a,6840,23)),Promise.resolve().then(a.t.bind(a,8771,23)),Promise.resolve().then(a.t.bind(a,3225,23)),Promise.resolve().then(a.t.bind(a,9295,23)),Promise.resolve().then(a.t.bind(a,3982,23))},8168:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var n=a(2295);a(4502);var r=a(3729),s=a(708),o=a(2254),i=a(5428),l=a(2065),c=a(783),d=a.n(c),u=a(2899),h=a(7199),m=a(2148);function p({params:e}){let t=e.external,a=(0,i.fK)(),c=(0,i.LP)(),p=(0,o.useRouter)(),x=(0,i.U2)("rol"),[j,v]=(0,r.useState)({}),[f,b]=(0,r.useState)([]),[g,y]=(0,r.useState)([]);(0,r.useEffect)(()=>{(async()=>{let e=(await (0,m.ZH)("/admin/ventas/obtener/e/"+a,c)).datos.find(e=>e.external_id===t);console.log("ventaEncontrada",e),e&&(v(e),w("numero",e.numero),w("recargo",e.recargo),w("total",e.total),y(e.auto||[]),w("total",e.auto.reduce((e,t)=>e+t.precio,0)));let n=await (0,m.ZH)("admin/autosDisponibles",c);console.log("autos",n),b(n.datos)})()},[a,c,w,t]);let{register:Z,handleSubmit:P,formState:k,setValue:w,watch:N}=(0,s.cI)({defaultValues:j}),{errors:C}=k,_=e=>{g.some(t=>t.external_id===e.external_id)||(y([...g,e]),w("auto",null),w("recargo",g.reduce((e,t)=>(t.recargo||0)+e,0)+(e.recargo||0)),w("total",parseFloat(N("total"))+(e.precio||0)+(e.recargo||0)))},S=e=>{let t=g[e],a=[...g];a.splice(e,1),y(a),w("recargo",a.reduce((e,t)=>(t.recargo||0)+e,0)),w("total",parseFloat(N("total"))-(t.precio||0)-(t.recargo||0))};return(0,n.jsxs)("div",{className:"row",children:["gerente"===x?n.jsx(u.Z,{}):n.jsx(h.Z,{}),n.jsx("h1",{children:"Modificar Venta"}),n.jsx("div",{className:"col-4 container-fluid",children:(0,n.jsxs)("form",{onSubmit:P(e=>{console.log("data",e);var a={autos:g.map(e=>e.external_id)};console.log("dato",a),(0,m.Lw)("admin/venta/editar/"+t,a,c).then(e=>{console.log("info",e),200===e.code?((0,l.Z)("Venta modificada correctamente","OK","sucess"),p.push("/ventas/propias")):(0,l.Z)("Error al modificar la venta!","Error","error")})}),children:[(0,n.jsxs)("div",{className:"form-outline form-white mb-4",children:[n.jsx("label",{className:"form-label",children:"N\xfamero"}),n.jsx("input",{...Z("numero"),name:"numero",id:"numero",className:`form-control ${C.numero?"is-invalid":""}`,readOnly:!0})]}),(0,n.jsxs)("div",{className:"form-outline form-white mb-4",children:[n.jsx("label",{className:"form-label",children:"Total"}),n.jsx("input",{...Z("total"),name:"total",id:"total",className:`form-control ${C.total?"is-invalid":""}`,readOnly:!0})]}),(0,n.jsxs)("div",{className:"form-outline form-white mb-4",children:[n.jsx("label",{children:"Autos Disponibles:"}),(0,n.jsxs)("select",{...Z("auto"),className:`form-select ${C.auto?"is-invalid":""}`,children:[n.jsx("option",{value:"",children:"Seleccionar Auto"}),f.map(e=>(0,n.jsxs)("option",{value:e.external_id,children:[e.marca," ",e.modelo," - ",e.color," (",e.anio,")"]},e.external_id))]}),n.jsx("div",{className:"alert alert-danger invalid-feedback",children:C.auto?.message}),n.jsx("button",{type:"button",onClick:()=>_(f.find(e=>e.external_id===N("auto"))),className:"btn btn-outline-dark btn-sm d-block mx-auto mt-3 px-5",children:"Agregar Auto"})]}),(0,n.jsxs)("div",{className:"form-outline form-white mb-4",children:[n.jsx("label",{children:"Autos Seleccionados:"}),(0,n.jsxs)("table",{className:"table",children:[n.jsx("thead",{children:(0,n.jsxs)("tr",{children:[n.jsx("th",{children:"Marca"}),n.jsx("th",{children:"Modelo"}),n.jsx("th",{children:"A\xf1o"}),n.jsx("th",{children:"Color"}),n.jsx("th",{children:"Precio"}),n.jsx("th",{children:"Acciones"})]})}),n.jsx("tbody",{children:g.map((e,t)=>(0,n.jsxs)("tr",{children:[n.jsx("td",{children:e.marca}),n.jsx("td",{children:e.modelo}),n.jsx("td",{children:e.anio}),n.jsx("td",{children:e.color}),n.jsx("td",{children:e.precio}),n.jsx("td",{children:n.jsx("button",{type:"button",onClick:()=>S(t),className:"btn btn-danger btn-sm d-block mx-auto",children:"Quitar"})})]},e.external_id))})]})]}),(0,n.jsxs)("div",{className:"d-flex gap-4",children:[n.jsx("button",{type:"submit",className:"btn btn-outline-dark btn-lg px-5",id:"boton-nuevo-auto",children:"Guardar"}),n.jsx(d(),{href:"/ventas/propias",children:n.jsx("button",{className:"btn btn-outline-dark btn-lg px-5",children:"Cancelar"})})]})]})})]})}},2065:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var n=a(3963),r=a.n(n);let s=(e,t,a="success")=>r()(t,e,a,{button:"ACEPTAR",closeOnEsc:!0,closeOnClickOutside:!0,timer:3e3})},2899:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d});var n=a(2295),r=a(5428);a(783);var s=a(2065),o=a(2254),i=a(633),l=a(5964),c=a(8522);function d(){let e=(0,o.useRouter)(),t=async()=>{await (0,r.jH)(),(0,s.Z)("Adi\xf3s!","Hasta la pr\xf3xima"),e.push("/"),e.refresh()};return n.jsx(i.Z,{bg:"dark",expand:"lg",variant:"dark",children:(0,n.jsxs)("div",{className:"container-fluid",children:[n.jsx(i.Z.Toggle,{"aria-controls":"navbarSupportedContent"}),n.jsx(i.Z.Collapse,{id:"navbarSupportedContent",children:(0,n.jsxs)(l.Z,{className:"me-auto",children:[n.jsx(l.Z.Link,{onClick:t,children:"Cerrar Sesi\xf3n"}),(0,n.jsxs)(c.Z,{title:"Ventas",id:"basic-nav-dropdown",children:[n.jsx(c.Z.Item,{href:"/ventas",children:"Ventas"}),n.jsx(c.Z.Item,{href:"/ventas/propias",children:"Mis Ventas"})]}),(0,n.jsxs)(c.Z,{title:"Autos",id:"basic-nav-dropdown",children:[n.jsx(c.Z.Item,{href:"/autos",children:"Autos"}),n.jsx(c.Z.Item,{href:"/autos/vendidos",children:"Autos Vendidos"}),n.jsx(c.Z.Item,{href:"/autos/disponibles",children:"Autos Disponibles"})]}),n.jsx(l.Z.Link,{href:"/compradores",children:"Compradores"})]})})]})})}},7199:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d});var n=a(2295),r=a(5428);a(783);var s=a(2065),o=a(2254),i=a(633),l=a(5964),c=a(8522);function d(){let e=(0,o.useRouter)(),t=async()=>{await (0,r.jH)(),(0,s.Z)("Adi\xf3s!","Hasta la pr\xf3xima"),e.push("/"),e.refresh()};return n.jsx(i.Z,{bg:"dark",expand:"lg",variant:"dark",children:(0,n.jsxs)("div",{className:"container-fluid",children:[n.jsx(i.Z.Toggle,{"aria-controls":"navbarSupportedContent"}),n.jsx(i.Z.Collapse,{id:"navbarSupportedContent",children:(0,n.jsxs)(l.Z,{className:"me-auto",children:[n.jsx(l.Z.Link,{onClick:t,children:"Cerrar Sesi\xf3n"}),(0,n.jsxs)(c.Z,{title:"Ventas",id:"basic-nav-dropdown",children:[n.jsx(c.Z.Item,{href:"/ventas",children:"Ventas"}),n.jsx(c.Z.Item,{href:"/ventas/propias",children:"Mis Ventas"})]}),n.jsx(l.Z.Link,{href:"/compradores",children:"Compradores"})]})})]})})}},2148:(e,t,a)=>{"use strict";a.d(t,{Lw:()=>c,MX:()=>o,ZH:()=>s,lf:()=>i,m3:()=>r,xC:()=>l});let n="https://back-end-autos.onrender.com/api/";async function r(e,t){let a=[];a={"Content-Type":"application/json"};let r=await fetch(n+e,{method:"POST",headers:a,body:JSON.stringify(t)});return await r.json()}async function s(e,t){let a=await fetch(n+e,{method:"GET",headers:{"Content-type":"application/json",token:t},cache:"no-store"});return await a.json()}async function o(e,t,a){let r=await fetch(n+e+a,{method:"GET",headers:{"Content-type":"application/json",token:t},cache:"no-store"});return await r.json()}async function i(e,t,a){let r=await fetch(n+e,{method:"POST",headers:{"Content-type":"application/json",token:a},body:JSON.stringify(t)});return await r.json()}async function l(e,t,a){let r=await fetch(n+e,{method:"POST",headers:{token:a},body:t});return await r.json()}async function c(e,t,a){let r=await fetch(n+e,{method:"PATCH",headers:{"Content-type":"application/json",token:a},body:JSON.stringify(t)});return await r.json()}},5428:(e,t,a)=>{"use strict";a.d(t,{Fr:()=>s,LP:()=>o,U2:()=>r,a1:()=>n,fK:()=>i,jH:()=>l,pR:()=>c});let n=(e,t)=>{},r=e=>{},s=e=>{},o=()=>{},i=()=>{},l=()=>{},c=()=>{}},3384:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var n=a(5036),r=a(4932),s=a.n(r);function o({children:e}){return(0,n.jsxs)("html",{lang:"en",children:[(0,n.jsxs)("head",{children:[n.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),n.jsx("title",{children:"Autos"}),n.jsx("script",{src:"https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js",async:!0})]}),n.jsx("body",{className:s().className,children:n.jsx("div",{className:"container-fluid",children:n.jsx("section",{children:e})})})]})}a(7272),a(8399)},5192:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>s,__esModule:()=>r,default:()=>o});let n=(0,a(6843).createProxy)(String.raw`/home/ivan/WorkSpace/Practica3/front-end/venta-autos/app/ventas/editar/[external]/page.jsx`),{__esModule:r,$$typeof:s}=n,o=n.default},7272:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),n=t.X(0,[786,730,950,412],()=>a(5209));module.exports=n})();