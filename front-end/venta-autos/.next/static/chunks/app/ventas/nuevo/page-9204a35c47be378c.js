(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[973],{8980:function(e,n,t){Promise.resolve().then(t.bind(t,9689))},9689:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return x}});var r=t(7437),a=t(5691),s=t(2265),o=t(1865),i=t(9701),l=t(4033),c=t(3369),d=t(5944),u=t(1396),h=t.n(u),m=t(6468),f=t(4174),p=t(8170);function x(){var e,n,t;let u=(0,c.fK)(),x=(0,c.LP)(),j=(0,l.useRouter)(),v=(0,c.U2)("rol"),b=a.Ry().shape({numero:a.Rx().required("Ingrese el n\xfamero de la venta")}),g={resolver:(0,i.X)(b)},{register:y,handleSubmit:N,formState:Z,setValue:k,watch:C}=(0,o.cI)(g),{errors:w}=Z,[S,A]=(0,s.useState)([]),[O,V]=(0,s.useState)([]),[I,_]=(0,s.useState)([]);(0,s.useEffect)(()=>{(async()=>{try{let e=await (0,p.ZH)("admin/compradores",x),n=await (0,p.ZH)("admin/autosDisponibles",x);A(e.datos),V(n.datos)}catch(e){console.error("Error obteniendo informaci\xf3n de compradores o autos",e)}})()},[x]);let E=e=>{I.some(n=>n.external_id===e.external_id)||(_([...I,e]),k("auto",null))},P=e=>{let n=[...I];n.splice(e,1),_(n)};return(0,r.jsxs)("div",{className:"row",children:["gerente"===v?(0,r.jsx)(m.Z,{}):(0,r.jsx)(f.Z,{}),(0,r.jsx)("h1",{children:"Registrar Venta"}),(0,r.jsx)("div",{className:"col-4 container-fluid",children:(0,r.jsxs)("form",{onSubmit:N(e=>{console.log("data",e);var n={numero:e.numero,empleado:u,comprador:e.comprador,autos:I.map(e=>e.external_id)};console.log("dato",n),(0,p.lf)("admin/venta/guardar",n,x).then(e=>{console.log("info",e),200===e.code?((0,d.Z)("Venta registrada correctamente","OK","sucess"),j.push("/ventas/propias")):(0,d.Z)("Error al agregar la venta!","Error","error")})}),children:[(0,r.jsxs)("div",{className:"form-outline form-white mb-4",children:[(0,r.jsx)("label",{className:"form-label",children:"N\xfamero"}),(0,r.jsx)("input",{...y("numero"),name:"numero",id:"numero",className:"form-control ".concat(w.numero?"is-invalid":"")}),(0,r.jsx)("div",{className:"alert alert-danger invalid-feedback",children:null===(e=w.numero)||void 0===e?void 0:e.message})]}),(0,r.jsxs)("div",{className:"form-outline form-white mb-4",children:[(0,r.jsx)("label",{className:"form-label",children:"Comprador"}),(0,r.jsxs)("select",{...y("comprador"),className:"form-select ".concat(w.comprador?"is-invalid":""),children:[(0,r.jsx)("option",{value:"",children:"Seleccionar Comprador"}),S.map((e,n)=>(0,r.jsx)("option",{value:e.external_id,children:e.nombres+" "+e.apellidos+" - "+e.cedula},n))]}),(0,r.jsx)("div",{className:"alert alert-danger invalid-feedback",children:null===(n=w.comprador)||void 0===n?void 0:n.message})]}),(0,r.jsxs)("div",{className:"form-outline form-white mb-4",children:[(0,r.jsx)("label",{children:"Autos Disponibles:"}),(0,r.jsxs)("select",{...y("auto"),className:"form-select ".concat(w.auto?"is-invalid":""),children:[(0,r.jsx)("option",{value:"",children:"Seleccionar Auto"}),O.map(e=>(0,r.jsxs)("option",{value:e.external_id,children:[e.marca," ",e.modelo," - ",e.color," (",e.anio,")"]},e.external_id))]}),(0,r.jsx)("div",{className:"alert alert-danger invalid-feedback",children:null===(t=w.auto)||void 0===t?void 0:t.message}),(0,r.jsx)("button",{type:"button",onClick:()=>E(O.find(e=>e.external_id===C("auto"))),className:"btn btn-outline-dark btn-sm d-block mx-auto mt-3 px-5",children:"Agregar Auto"})]}),(0,r.jsxs)("div",{className:"form-outline form-white mb-4",children:[(0,r.jsx)("label",{children:"Autos Seleccionados:"}),(0,r.jsxs)("table",{className:"table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Marca"}),(0,r.jsx)("th",{children:"Modelo"}),(0,r.jsx)("th",{children:"A\xf1o"}),(0,r.jsx)("th",{children:"Color"}),(0,r.jsx)("th",{children:"Precio"}),(0,r.jsx)("th",{children:"Acciones"})]})}),(0,r.jsx)("tbody",{children:I.map((e,n)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.marca}),(0,r.jsx)("td",{children:e.modelo}),(0,r.jsx)("td",{children:e.anio}),(0,r.jsx)("td",{children:e.color}),(0,r.jsx)("td",{children:e.precio}),(0,r.jsx)("td",{children:(0,r.jsx)("button",{type:"button",onClick:()=>P(n),children:"Eliminar"})})]},e.external_id))})]})]}),(0,r.jsxs)("div",{className:"d-flex gap-4",children:[(0,r.jsx)("button",{type:"submit",className:"btn btn-outline-dark btn-lg px-5",id:"boton-nuevo-auto",children:"Agregar"}),(0,r.jsx)(h(),{href:"/ventas/propias",children:(0,r.jsx)("button",{className:"btn btn-outline-dark btn-lg px-5",children:"Cancelar"})})]})]})})]})}},5944:function(e,n,t){"use strict";var r=t(5003),a=t.n(r);n.Z=function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"success";return a()(n,e,t,{button:"ACEPTAR",closeOnEsc:!0,closeOnClickOutside:!0,timer:3e3})}},6468:function(e,n,t){"use strict";t.d(n,{Z:function(){return d}});var r=t(7437),a=t(3369);t(1396);var s=t(5944),o=t(4033),i=t(2580),l=t(7380),c=t(8776);function d(){let e=(0,o.useRouter)(),n=async()=>{await (0,a.jH)(),(0,s.Z)("Adi\xf3s!","Hasta la pr\xf3xima"),e.push("/"),e.refresh()};return(0,r.jsx)(i.Z,{bg:"dark",expand:"lg",variant:"dark",children:(0,r.jsxs)("div",{className:"container-fluid",children:[(0,r.jsx)(i.Z.Toggle,{"aria-controls":"navbarSupportedContent"}),(0,r.jsx)(i.Z.Collapse,{id:"navbarSupportedContent",children:(0,r.jsxs)(l.Z,{className:"me-auto",children:[(0,r.jsx)(l.Z.Link,{onClick:n,children:"Cerrar Sesi\xf3n"}),(0,r.jsxs)(c.Z,{title:"Ventas",id:"basic-nav-dropdown",children:[(0,r.jsx)(c.Z.Item,{href:"/ventas",children:"Ventas"}),(0,r.jsx)(c.Z.Item,{href:"/ventas/propias",children:"Mis Ventas"})]}),(0,r.jsxs)(c.Z,{title:"Autos",id:"basic-nav-dropdown",children:[(0,r.jsx)(c.Z.Item,{href:"/autos",children:"Autos"}),(0,r.jsx)(c.Z.Item,{href:"/autos/vendidos",children:"Autos Vendidos"}),(0,r.jsx)(c.Z.Item,{href:"/autos/disponibles",children:"Autos Disponibles"})]}),(0,r.jsx)(l.Z.Link,{href:"/compradores",children:"Compradores"})]})})]})})}},4174:function(e,n,t){"use strict";t.d(n,{Z:function(){return d}});var r=t(7437),a=t(3369);t(1396);var s=t(5944),o=t(4033),i=t(2580),l=t(7380),c=t(8776);function d(){let e=(0,o.useRouter)(),n=async()=>{await (0,a.jH)(),(0,s.Z)("Adi\xf3s!","Hasta la pr\xf3xima"),e.push("/"),e.refresh()};return(0,r.jsx)(i.Z,{bg:"dark",expand:"lg",variant:"dark",children:(0,r.jsxs)("div",{className:"container-fluid",children:[(0,r.jsx)(i.Z.Toggle,{"aria-controls":"navbarSupportedContent"}),(0,r.jsx)(i.Z.Collapse,{id:"navbarSupportedContent",children:(0,r.jsxs)(l.Z,{className:"me-auto",children:[(0,r.jsx)(l.Z.Link,{onClick:n,children:"Cerrar Sesi\xf3n"}),(0,r.jsxs)(c.Z,{title:"Ventas",id:"basic-nav-dropdown",children:[(0,r.jsx)(c.Z.Item,{href:"/ventas",children:"Ventas"}),(0,r.jsx)(c.Z.Item,{href:"/ventas/propias",children:"Mis Ventas"})]}),(0,r.jsx)(l.Z.Link,{href:"/compradores",children:"Compradores"})]})})]})})}},8170:function(e,n,t){"use strict";t.d(n,{Lw:function(){return c},MX:function(){return o},ZH:function(){return s},lf:function(){return i},m3:function(){return a},xC:function(){return l}});let r="http://localhost:3000/api/";async function a(e,n){let t=[];t={"Content-Type":"application/json"};let a=await fetch(r+e,{method:"POST",headers:t,body:JSON.stringify(n)});return await a.json()}async function s(e,n){let t=await fetch(r+e,{method:"GET",headers:{"Content-type":"application/json",token:n},cache:"no-store"});return await t.json()}async function o(e,n,t){let a=await fetch(r+e+t,{method:"GET",headers:{"Content-type":"application/json",token:n},cache:"no-store"});return await a.json()}async function i(e,n,t){let a=await fetch(r+e,{method:"POST",headers:{"Content-type":"application/json",token:t},body:JSON.stringify(n)});return await a.json()}async function l(e,n,t){let a=await fetch(r+e,{method:"POST",headers:{token:t},body:n});return await a.json()}async function c(e,n,t){let a=await fetch(r+e,{method:"PATCH",headers:{"Content-type":"application/json",token:t},body:JSON.stringify(n)});return await a.json()}},3369:function(e,n,t){"use strict";t.d(n,{Fr:function(){return s},LP:function(){return o},U2:function(){return a},a1:function(){return r},fK:function(){return i},jH:function(){return l},pR:function(){return c}});let r=(e,n)=>{sessionStorage.setItem(e,n)},a=e=>sessionStorage.getItem(e),s=e=>{sessionStorage.setItem("token",e)},o=()=>sessionStorage.getItem("token"),i=()=>sessionStorage.getItem("external_id"),l=()=>{sessionStorage.clear()},c=()=>{var e=sessionStorage.getItem("token");return e&&("undefined"!==e||null!==e||"null"!==e)}},9701:function(e,n,t){"use strict";t.d(n,{X:function(){return c}});var r=t(1865),a=function(e,n,t){if(e&&"reportValidity"in e){var a=(0,r.U2)(t,n);e.setCustomValidity(a&&a.message||""),e.reportValidity()}},s=function(e,n){var t=function(t){var r=n.fields[t];r&&r.ref&&"reportValidity"in r.ref?a(r.ref,t,e):r.refs&&r.refs.forEach(function(n){return a(n,t,e)})};for(var r in n.fields)t(r)},o=function(e,n){n.shouldUseNativeValidation&&s(e,n);var t={};for(var a in e){var o=(0,r.U2)(n.fields,a),c=Object.assign(e[a]||{},{ref:o&&o.ref});if(l(n.names||Object.keys(e),a)){var d=Object.assign({},i((0,r.U2)(t,a)));(0,r.t8)(d,"root",c),(0,r.t8)(t,a,d)}else(0,r.t8)(t,a,c)}return t},i=function(e){return Array.isArray(e)?e.filter(Boolean):[]},l=function(e,n){return e.some(function(e){return e.startsWith(n+".")})};function c(e,n,t){return void 0===n&&(n={}),void 0===t&&(t={}),function(a,i,l){try{return Promise.resolve(function(r,o){try{var c=(n.context,Promise.resolve(e["sync"===t.mode?"validateSync":"validate"](a,Object.assign({abortEarly:!1},n,{context:i}))).then(function(e){return l.shouldUseNativeValidation&&s({},l),{values:t.raw?a:e,errors:{}}}))}catch(e){return o(e)}return c&&c.then?c.then(void 0,o):c}(0,function(e){var n;if(!e.inner)throw e;return{values:{},errors:o((n=!l.shouldUseNativeValidation&&"all"===l.criteriaMode,(e.inner||[]).reduce(function(e,t){if(e[t.path]||(e[t.path]={message:t.message,type:t.type}),n){var a=e[t.path].types,s=a&&a[t.type];e[t.path]=(0,r.KN)(t.path,n,e,t.type,s?[].concat(s,t.message):t.message)}return e},{})),l)}}))}catch(e){return Promise.reject(e)}}}}},function(e){e.O(0,[595,664,729,971,938,744],function(){return e(e.s=8980)}),_N_E=e.O()}]);